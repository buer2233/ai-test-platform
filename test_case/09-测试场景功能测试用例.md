# 测试场景（测试用例）功能测试用例

## 一、测试概述

### 1.1 测试目标

本文档描述了"测试场景"功能的完整测试用例，该功能允许用户将多个接口测试用例串联成一个完整的测试流程。

### 1.2 测试范围

| 模块 | 测试内容 |
|------|---------|
| 场景管理 | 创建、编辑、删除、克隆场景 |
| 步骤管理 | 添加、编辑、删除、排序步骤 |
| 场景执行 | 执行场景、查看结果、取消执行 |
| 变量传递 | 提取变量、使用变量、变量验证 |
| 断言验证 | 步骤断言、场景断言 |
| 数据管理 | 数据分级存储、自动清理 |

### 1.3 前置条件

1. 系统已正常运行
2. 已创建测试项目
3. 已配置测试环境
4. 已创建基础接口测试用例

---

## 二、功能测试用例

### TC001: 创建测试场景

| 项目 | 内容 |
|------|------|
| **用例编号** | TC001 |
| **用例名称** | 创建测试场景 |
| **优先级** | 高 |
| **测试类型** | 功能测试 |
| **前置条件** | 已登录系统，存在测试项目 |
| **测试步骤** | 1. 进入"场景管理"页面<br>2. 点击"新建场景"按钮<br>3. 填写场景名称："用户注册流程"<br>4. 填写场景描述："测试用户从注册到登录的完整流程"<br>5. 选择所属项目<br>6. 配置执行参数：<br>   - 失败时停止：是<br>   - 超时时间：30秒<br>7. 点击"保存"按钮 |
| **预期结果** | 场景创建成功，出现在场景列表中 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC002: 添加场景步骤

| 项目 | 内容 |
|------|------|
| **用例编号** | TC002 |
| **用例名称** | 添加场景步骤 |
| **优先级** | 高 |
| **测试类型** | 功能测试 |
| **前置条件** | 已创建测试场景，存在多个接口测试用例 |
| **测试步骤** | 1. 进入场景详情页<br>2. 点击"添加步骤"按钮<br>3. 从用例列表中选择第一个接口用例："发送验证码"<br>4. 设置步骤顺序：1<br>5. 设置步骤名称："步骤1：发送验证码"<br>6. 配置步骤断言（可选）<br>7. 点击"确认添加"<br>8. 重复步骤2-7，添加更多步骤 |
| **预期结果** | 所有步骤成功添加，按顺序显示在步骤列表中 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC003: 步骤拖拽排序

| 项目 | 内容 |
|------|------|
| **用例编号** | TC003 |
| **用例名称** | 步骤拖拽排序 |
| **优先级** | 中 |
| **测试类型** | 功能测试 |
| **前置条件** | 场景中已添加至少3个步骤 |
| **测试步骤** | 1. 进入场景详情页<br>2. 查看当前步骤顺序<br>3. 拖拽步骤3到步骤1的位置<br>4. 保存更改 |
| **预期结果** | 步骤顺序更新，步骤3变成新的步骤1，其他步骤顺序相应调整 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC004: 执行测试场景 - 全部通过

| 项目 | 内容 |
|------|------|
| **用例编号** | TC004 |
| **用例名称** | 执行测试场景 - 全部通过 |
| **优先级** | 高 |
| **测试类型** | 功能测试 |
| **前置条件** | 场景已配置完成，所有接口用例正常 |
| **测试步骤** | 1. 进入场景详情页<br>2. 选择执行环境<br>3. 点击"执行场景"按钮<br>4. 观察执行进度<br>5. 等待执行完成 |
| **预期结果** | 1. 场景执行状态变为"COMPLETED"<br>2. 所有步骤状态为"PASSED"<br>3. 通过步骤数 = 总步骤数<br>4. 生成执行报告 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC005: 执行测试场景 - 中间步骤失败

| 项目 | 内容 |
|------|------|
| **用例编号** | TC005 |
| **用例名称** | 执行测试场景 - 中间步骤失败 |
| **优先级** | 高 |
| **测试类型** | 功能测试 |
| **前置条件** | 场景已配置，步骤2配置了错误的断言 |
| **测试步骤** | 1. 进入场景详情页<br>2. 确认"失败时停止"配置为"是"<br>3. 点击"执行场景"<br>4. 观察执行过程 |
| **预期结果** | 1. 步骤1执行通过<br>2. 步骤2执行失败<br>3. 步骤3及后续步骤状态为"SKIPPED"<br>4. 场景执行状态为"FAILED"<br>5. 失败步骤显示详细错误信息 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC006: 执行测试场景 - 失败继续执行

| 项目 | 内容 |
|------|------|
| **用例编号** | TC006 |
| **用例名称** | 执行测试场景 - 失败继续执行 |
| **优先级** | 中 |
| **测试类型** | 功能测试 |
| **前置条件** | 场景已配置，"失败时停止"设置为"否" |
| **测试步骤** | 1. 进入场景详情页<br>2. 确认配置为"失败时继续"<br>3. 点击"执行场景"<br>4. 观察执行过程 |
| **预期结果** | 1. 步骤1执行通过<br>2. 步骤2执行失败，但继续执行<br>3. 步骤3正常执行<br>4. 所有步骤都执行完成<br>5. 场景状态为"COMPLETED"（有失败） |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

---

## 三、变量传递测试用例

### TC007: 变量提取和使用

| 项目 | 内容 |
|------|------|
| **用例编号** | TC007 |
| **用例名称** | 变量提取和使用 |
| **优先级** | 高 |
| **测试类型** | 功能测试 |
| **前置条件** | 已创建包含变量提取配置的接口用例 |
| **测试步骤** | 1. 创建场景，添加2个步骤<br>2. 步骤1：登录接口<br>   - 配置提取：`login_token = $.data.token`<br>   - 配置提取：`user_id = $.data.user.id`<br>3. 步骤2：获取用户信息<br>   - URL: `/api/user/${scenario.user_id}`<br>   - 请求头: `Authorization: Bearer ${scenario.login_token}`<br>4. 执行场景<br>5. 查看步骤2的请求数据 |
| **预期结果** | 1. 步骤1成功提取变量<br>2. 步骤2的URL正确替换为 `/api/user/123`（假设user_id=123）<br>3. 步骤2的请求头包含正确的Token<br>4. 两个步骤都执行通过 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC008: 多变量连续传递

| 项目 | 内容 |
|------|------|
| **用例编号** | TC008 |
| **用例名称** | 多变量连续传递 |
| **优先级** | 中 |
| **测试类型** | 功能测试 |
| **前置条件** | 已创建多步骤场景 |
| **测试步骤** | 1. 步骤1：登录 → 提取 token, user_id<br>2. 步骤2：创建订单 → 提取 order_id<br>3. 步骤3：查询订单 → 使用 ${scenario.order_id}<br>4. 步骤4：取消订单 → 使用 ${scenario.order_id}<br>5. 执行场景 |
| **预期结果** | 所有步骤成功，变量在各步骤间正确传递 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC009: 变量作用域验证

| 项目 | 内容 |
|------|------|
| **用例编号** | TC009 |
| **用例名称** | 变量作用域验证 |
| **优先级** | 中 |
| **测试类型** | 功能测试 |
| **前置条件** | 已创建多步骤场景 |
| **测试步骤** | 1. 步骤1提取变量 `var1`，作用域设为 `scenario`<br>2. 步骤2使用 `${scenario.var1}`<br>3. 步骤3提取变量 `var2`，作用域设为 `local`<br>4. 步骤4尝试使用 `${local.var2}`<br>5. 执行场景 |
| **预期结果** | 1. 步骤2可以正常使用 `scenario.var1`<br>2. 步骤4无法使用 `local.var2`（作用域为步骤级）<br>3. 执行日志中有变量作用域错误提示 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC010: 环境变量使用

| 项目 | 内容 |
|------|------|
| **用例编号** | TC010 |
| **用例名称** | 环境变量使用 |
| **优先级** | 中 |
| **测试类型** | 功能测试 |
| **前置条件** | 环境中已配置全局变量 `base_url` 和 `api_key` |
| **测试步骤** | 1. 创建场景，选择执行环境<br>2. 步骤1配置：<br>   - URL: `${env.base_url}/api/user`<br>   - 请求头: `X-API-Key: ${env.api_key}`<br>3. 执行场景 |
| **预期结果** | 环境变量正确替换，请求成功发送 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

---

## 四、断言测试用例

### TC011: 步骤级断言验证

| 项目 | 内容 |
|------|------|
| **用例编号** | TC011 |
| **用例名称** | 步骤级断言验证 |
| **优先级** | 高 |
| **测试类型** | 功能测试 |
| **前置条件** | 已创建场景 |
| **测试步骤** | 1. 进入场景编辑页<br>2. 选择步骤1<br>3. 添加断言：<br>   - 状态码：200<br>   - 响应时间：小于1000ms<br>   - JSON值：`$.code` 等于 `0`<br>4. 保存配置<br>5. 执行场景<br>6. 查看步骤执行结果 |
| **预期结果** | 1. 断言正确执行<br>2. 显示每个断言的通过/失败状态<br>3. 显示期望值和实际值对比 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC012: 多断言组合测试

| 项目 | 内容 |
|------|------|
| **用例编号** | TC012 |
| **用例名称** | 多断言组合测试 |
| **优先级** | 中 |
| **测试类型** | 功能测试 |
| **前置条件** | 已创建场景 |
| **测试步骤** | 1. 为步骤配置5个断言<br>2. 其中断言3故意配置错误的期望值<br>3. 执行场景<br>4. 查看断言结果 |
| **预期结果** | 1. 断言1、2、4、5通过<br>2. 断言3失败<br>3. 步骤状态为FAILED（有断言失败）<br>4. 显示失败原因 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC013: 步骤断言覆盖用例断言

| 项目 | 内容 |
|------|------|
| **用例编号** | TC013 |
| **用例名称** | 步骤断言覆盖用例断言 |
| **优先级** | 低 |
| **测试类型** | 功能测试 |
| **前置条件** | 接口用例已配置断言 |
| **测试步骤** | 1. 创建场景，添加步骤（关联已有用例）<br>2. 为步骤配置新的断言（覆盖用例断言）<br>3. 执行场景<br>4. 查看执行的断言 |
| **预期结果** | 1. 使用步骤级断言进行验证<br>2. 不使用用例默认断言 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

---

## 五、数据管理测试用例

### TC014: 状态码200时数据简化存储

| 项目 | 内容 |
|------|------|
| **用例编号** | TC014 |
| **用例名称** | 状态码200时数据简化存储 |
| **优先级** | 中 |
| **测试类型** | 功能测试 |
| **前置条件** | 已创建场景 |
| **测试步骤** | 1. 执行场景（所有接口返回200）<br>2. 进入执行记录详情<br>3. 查看步骤结果数据 |
| **预期结果** | 1. 只存储 `request_summary`（方法、URL、部分请求头）<br>2. 不存储完整的请求/响应数据<br>3. 数据库占用空间较小 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC015: 非状态码200时完整数据存储

| 项目 | 内容 |
|------|------|
| **用例编号** | TC015 |
| **用例名称** | 非状态码200时完整数据存储 |
| **优先级** | 中 |
| **测试类型** | 功能测试 |
| **前置条件** | 已创建场景，某步骤会返回500错误 |
| **测试步骤** | 1. 执行场景<br>2. 进入执行记录详情<br>3. 查看失败步骤的数据 |
| **预期结果** | 1. 存储完整的 `request_full`<br>2. 存储完整的 `response_full`<br>3. 存储详细的 `error_info`<br>4. 方便排查问题 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC016: 7天前数据自动清理

| 项目 | 内容 |
|------|------|
| **用例编号** | TC016 |
| **用例名称** | 7天前数据自动清理 |
| **优先级** | 中 |
| **测试类型** | 功能测试 |
| **前置条件** | 存在8天前的执行记录 |
| **测试步骤** | 1. 记录当前执行记录数量<br>2. 等待定时任务执行（凌晨）<br>3. 或手动触发清理任务<br>4. 查看执行记录数量 |
| **预期结果** | 1. 7天前的记录被删除<br>2. 最近7天的记录保留<br>3. 数据库空间释放 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

---

## 六、界面交互测试用例

### TC017: 实时执行监控

| 项目 | 内容 |
|------|------|
| **用例编号** | TC017 |
| **用例名称** | 实时执行监控 |
| **优先级** | 高 |
| **测试类型** | 功能测试 |
| **前置条件** | 已创建场景 |
| **测试步骤** | 1. 点击"执行场景"<br>2. 打开执行监控页面<br>3. 观察以下内容：<br>   - 执行进度条<br>   - 当前执行步骤<br>   - 实时日志<br>   - 变量查看器 |
| **预期结果** | 1. 进度条实时更新<br>2. 显示当前正在执行的步骤<br>3. 日志实时滚动<br>4. 提取的变量实时显示 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC018: 执行报告查看

| 项目 | 内容 |
|------|------|
| **用例编号** | TC018 |
| **用例名称** | 执行报告查看 |
| **优先级** | 中 |
| **测试类型** | 功能测试 |
| **前置条件** | 场景已执行完成 |
| **测试步骤** | 1. 进入"执行记录"页面<br>2. 点击某条执行记录<br>3. 查看执行报告 |
| **预期结果** | 报告包含：<br>1. 执行摘要（总数、通过、失败）<br>2. 每个步骤的执行状态<br>3. 失败步骤的详细错误<br>4. 变量传递轨迹<br>5. 响应时间统计 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC019: 场景克隆功能

| 项目 | 内容 |
|------|------|
| **用例编号** | TC019 |
| **用例名称** | 场景克隆功能 |
| **优先级** | 低 |
| **测试类型** | 功能测试 |
| **前置条件** | 已创建场景 |
| **测试步骤** | 1. 进入场景列表<br>2. 点击某场景的"克隆"按钮<br>3. 修改克隆场景的名称<br>4. 保存 |
| **预期结果** | 1. 新场景创建成功<br>2. 包含原场景的所有步骤<br>3. 步骤配置完全一致 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC020: 取消正在执行的场景

| 项目 | 内容 |
|------|------|
| **用例编号** | TC020 |
| **用例名称** | 取消正在执行的场景 |
| **优先级** | 中 |
| **测试类型** | 功能测试 |
| **前置条件** | 场景正在执行中 |
| **测试步骤** | 1. 在执行监控页面<br>2. 点击"取消执行"按钮<br>3. 确认取消 |
| **预期结果** | 1. 正在执行的步骤完成或中断<br>2. 后续步骤状态变为SKIPPED<br>3. 场景状态变为CANCELLED<br>4. 显示取消时间 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

---

## 七、边界测试用例

### TC021: 空场景执行

| 项目 | 内容 |
|------|------|
| **用例编号** | TC021 |
| **用例名称** | 空场景执行 |
| **优先级** | 低 |
| **测试类型** | 边界测试 |
| **前置条件** | 已创建无步骤的场景 |
| **测试步骤** | 1. 尝试执行空场景 |
| **预期结果** | 提示"场景没有可执行的步骤"，无法执行 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC022: 超长步骤序列

| 项目 | 内容 |
|------|------|
| **用例编号** | TC022 |
| **用例名称** | 超长步骤序列 |
| **优先级** | 低 |
| **测试类型** | 边界测试 |
| **前置条件** | - |
| **测试步骤** | 1. 创建包含50个步骤的场景<br>2. 执行场景 |
| **预期结果** | 1. 所有步骤按顺序执行<br>2. 性能可接受<br>3. 无内存溢出 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC023: 步骤超时处理

| 项目 | 内容 |
|------|------|
| **用例编号** | TC023 |
| **用例名称** | 步骤超时处理 |
| **优先级** | 中 |
| **测试类型** | 边界测试 |
| **前置条件** | 场景超时配置为10秒 |
| **测试步骤** | 1. 某步骤配置接口会超时（模拟）<br>2. 执行场景 |
| **预期结果** | 1. 步骤在10秒后超时<br>2. 步骤状态为ERROR<br>3. 显示超时错误信息<br>4. 根据配置决定是否继续 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC024: 并发执行同一场景

| 项目 | 内容 |
|------|------|
| **用例编号** | TC024 |
| **用例名称** | 并发执行同一场景 |
| **优先级** | 中 |
| **测试类型** | 并发测试 |
| **前置条件** | 已创建场景 |
| **测试步骤** | 1. 同时启动3次场景执行<br>2. 观察各执行记录 |
| **预期结果** | 1. 3次执行独立进行<br>2. 变量池互不干扰<br>3. 产生3条独立的执行记录 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

---

## 八、性能测试用例

### TC025: 大量场景执行性能

| 项目 | 内容 |
|------|------|
| **用例编号** | TC025 |
| **用例名称** | 大量场景执行性能 |
| **优先级** | 低 |
| **测试类型** | 性能测试 |
| **前置条件** | 已创建100个场景 |
| **测试步骤** | 1. 执行所有场景<br>2. 记录执行时间 |
| **预期结果** | 1. 所有场景在合理时间内完成<br>2. 系统资源占用正常 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC026: 执行记录查询性能

| 项目 | 内容 |
|------|------|
| **用例编号** | TC026 |
| **用例名称** | 执行记录查询性能 |
| **优先级** | 低 |
| **测试类型** | 性能测试 |
| **前置条件** | 存在1000条执行记录 |
| **测试步骤** | 1. 查询执行记录列表<br>2. 筛选特定条件的记录<br>3. 记录查询时间 |
| **预期结果** | 查询响应时间 < 1秒 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

---

## 九、安全测试用例

### TC027: 变量注入攻击防护

| 项目 | 内容 |
|------|------|
| **用例编号** | TC027 |
| **用例名称** | 变量注入攻击防护 |
| **优先级** | 中 |
| **测试类型** | 安全测试 |
| **前置条件** | 已创建场景 |
| **测试步骤** | 1. 在提取的变量中注入恶意代码<br>2. 在后续步骤中使用该变量<br>3. 执行场景 |
| **预期结果** | 1. 变量被正确转义<br>2. 没有代码注入风险<br>3. 系统安全 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

### TC028: 跨项目场景隔离

| 项目 | 内容 |
|------|------|
| **用例编号** | TC028 |
| **用例名称** | 跨项目场景隔离 |
| **优先级** | 中 |
| **测试类型** | 安全测试 |
| **前置条件** | 存在多个项目 |
| **测试步骤** | 1. 用户A创建项目1的场景<br>2. 用户B尝试访问该项目1的场景<br>3. 尝试执行场景 |
| **预期结果** | 1. 用户B无法查看项目1的场景<br>2. 用户B无法执行场景<br>3. 权限控制正确 |
| **实际结果** | （待填写） |
| **测试状态** | （待测试） |

---

## 十、测试总结

### 10.1 测试统计

| 测试类型 | 用例数量 | 通过 | 失败 | 待测 |
|---------|---------|------|------|------|
| 功能测试 | 20 | - | - | 20 |
| 变量传递测试 | 4 | - | - | 4 |
| 断言测试 | 3 | - | - | 3 |
| 数据管理测试 | 3 | - | - | 3 |
| 界面交互测试 | 4 | - | - | 4 |
| 边界测试 | 4 | - | - | 4 |
| 性能测试 | 2 | - | - | 2 |
| 安全测试 | 2 | - | - | 2 |
| **总计** | **42** | - | - | **42** |

### 10.2 测试重点

1. **变量传递机制**：这是核心功能，需要充分测试
2. **执行控制**：失败停止/继续、取消执行等
3. **数据存储优化**：分级存储是否正确实现
4. **实时监控**：WebSocket推送是否稳定

### 10.3 测试数据准备

1. **基础接口用例**：
   - 登录接口
   - 注册接口
   - 获取用户信息接口
   - 创建订单接口
   - 查询订单接口

2. **测试环境**：
   - 配置基础URL
   - 配置全局变量

3. **测试数据**：
   - 测试账号
   - 测试商品数据
   - 测试订单数据

---

**文档版本**: v1.0
**创建日期**: 2026-01-04
**最后更新**: 2026-01-04
