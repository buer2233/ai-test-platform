# 环境管理 - 配置预览功能测试用例

## 功能描述
在环境管理列表页面，"配置统计"列下的全局请求头和全局变量图标支持点击交互：
1. 点击图标弹出配置预览/编辑对话框
2. 对话框仅显示对应的配置数据（全局请求头或全局变量）
3. 支持单独编辑、添加、删除配置项
4. 保存后自动刷新列表数据

## 测试环境
- 前端地址: http://localhost:3000/environments
- 后端地址: http://127.0.0.1:8000/

---

## 测试用例

### TC-ENV-001: 点击全局请求头图标显示对话框

**前置条件:**
- 已登录系统
- 环境管理列表页面已加载
- 至少存在一个环境配置，且该环境有全局请求头

**测试步骤:**
1. 访问环境管理页面
2. 找到"配置统计"列
3. 点击全局请求头图标（蓝色info类型的tag）

**预期结果:**
- 弹出"全局请求头配置"对话框
- 对话框标题显示"全局请求头配置"
- 对话框顶部显示环境名称标签
- 显示全局请求头配置说明："全局请求头将在该环境的所有请求中自动添加"
- 列表中显示该环境的所有全局请求头配置

**实际结果:**
- [ ] 待测试

---

### TC-ENV-002: 点击全局变量图标显示对话框

**前置条件:**
- 已登录系统
- 环境管理列表页面已加载
- 至少存在一个环境配置，且该环境有全局变量

**测试步骤:**
1. 访问环境管理页面
2. 找到"配置统计"列
3. 点击全局变量图标（绿色success类型的tag）

**预期结果:**
- 弹出"全局变量配置"对话框
- 对话框标题显示"全局变量配置"
- 对话框顶部显示环境名称标签
- 显示全局变量配置说明："全局变量可在请求中使用 ${variable_name} 格式引用"
- 列表中显示该环境的所有全局变量配置
- 底部显示使用示例提示

**实际结果:**
- [ ] 待测试

---

### TC-ENV-003: 全局请求头配置 - 添加新项

**前置条件:**
- 已打开全局请求头配置对话框

**测试步骤:**
1. 点击"添加请求头"按钮
2. 输入Header名称（如：X-Custom-Header）
3. 输入Header值（如：custom-value）
4. 点击"保存更改"按钮

**预期结果:**
- 保存成功提示："保存成功"
- 对话框自动关闭
- 环境列表自动刷新
- 对应环境的全局请求头数量增加

**实际结果:**
- [ ] 待测试

---

### TC-ENV-004: 全局变量配置 - 添加新项

**前置条件:**
- 已打开全局变量配置对话框

**测试步骤:**
1. 点击"添加变量"按钮
2. 输入变量名称（如：api_key）
3. 输入变量值（如：12345678）
4. 点击"保存更改"按钮

**预期结果:**
- 保存成功提示："保存成功"
- 对话框自动关闭
- 环境列表自动刷新
- 对应环境的全局变量数量增加

**实际结果:**
- [ ] 待测试

---

### TC-ENV-005: 编辑现有配置项

**前置条件:**
- 已打开配置对话框，且存在配置项

**测试步骤:**
1. 修改某个配置项的值
2. 点击"保存更改"按钮

**预期结果:**
- 保存成功提示："保存成功"
- 对话框自动关闭
- 环境列表自动刷新
- 修改的值已保存到后端

**实际结果:**
- [ ] 待测试

---

### TC-ENV-006: 删除配置项

**前置条件:**
- 已打开配置对话框，且存在至少一个配置项

**测试步骤:**
1. 点击某个配置项右侧的删除按钮（红色圆形按钮）
2. 点击"保存更改"按钮

**预期结果:**
- 保存成功提示："保存成功"
- 对话框自动关闭
- 环境列表自动刷新
- 对应环境的配置项数量减少

**实际结果:**
- [ ] 待测试

---

### TC-ENV-007: 清空全部配置

**前置条件:**
- 已打开配置对话框，且存在至少一个配置项

**测试步骤:**
1. 点击右上角"清空全部"按钮
2. 点击"保存更改"按钮

**预期结果:**
- 所有配置项被清空
- 保存成功提示："保存成功"
- 对话框自动关闭
- 环境列表自动刷新
- 对应环境的配置数量显示为0

**实际结果:**
- [ ] 待测试

---

### TC-ENV-008: 复制全部配置

**前置条件:**
- 已打开配置对话框，且存在配置项

**测试步骤:**
1. 点击右上角"复制全部"按钮

**预期结果:**
- 提示："已复制到剪贴板"
- 配置数据以JSON格式复制到剪贴板

**实际结果:**
- [ ] 待测试

---

### TC-ENV-009: 取消操作

**前置条件:**
- 已打开配置对话框

**测试步骤:**
1. 修改某个配置项的值
2. 点击"取消"按钮（不保存）

**预期结果:**
- 对话框关闭
- 修改未保存
- 环境列表未刷新

**实际结果:**
- [ ] 待测试

---

### TC-ENV-010: 点击tag的悬停效果

**前置条件:**
- 环境管理列表已加载

**测试步骤:**
1. 将鼠标悬停在全局请求头或全局变量的tag上

**预期结果:**
- Tag有轻微放大效果（scale 1.05）
- 显示阴影效果
- 鼠标指针变为手型（pointer）
- Tooltip提示"点击查看全局请求头"或"点击查看全局变量"

**实际结果:**
- [ ] 待测试

---

### TC-ENV-011: 空配置状态显示

**前置条件:**
- 存在一个没有全局请求头/变量的环境

**测试步骤:**
1. 点击配置数量为0的tag

**预期结果:**
- 对话框正常打开
- 显示空状态："暂无配置数据"
- 显示"添加请求头"或"添加变量"按钮

**实际结果:**
- [ ] 待测试

---

### TC-ENV-012: 变量值中包含变量引用的图标提示

**前置条件:**
- 已打开全局变量配置对话框
- 存在变量值包含${xxx}格式的变量

**预期步骤:**
1. 查看变量值的输入框

**预期结果:**
- 包含变量引用的值输入框右侧显示魔法棒图标
- 图标为蓝色（#409eff）

**实际结果:**
- [ ] 待测试

---

## 测试总结

### 测试状态
- [ ] 待执行
- [ ] 执行中
- [ ] 已完成

### 通过/失败统计
- 总用例数: 12
- 通过: ___
- 失败: ___
- 阻塞: ___

### 发现的问题
1. _问题记录_

### 测试结论
- [ ] 通过
- [ ] 不通过
- [ ] 部分通过

---

## 测试日期
- 测试人员: ___
- 测试日期: ___
